{"dependencies":[{"name":"./context_set","loc":{"line":1,"column":27}},{"name":"@stimulus/mutation-observers","loc":{"line":2,"column":34}}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Router = undefined;\n\nvar _map = require(\"babel-runtime/core-js/map\");\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _context_set = require(\"./context_set\");\n\nvar _mutationObservers = require(\"@stimulus/mutation-observers\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Router = /** @class */function () {\n  function Router(application) {\n    this.application = application;\n    this.tokenListObserver = new _mutationObservers.TokenListObserver(this.element, this.controllerAttribute, this);\n    this.contextSets = new _map2.default();\n  }\n  Object.defineProperty(Router.prototype, \"configuration\", {\n    get: function get() {\n      return this.application.configuration;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Router.prototype, \"element\", {\n    get: function get() {\n      return this.configuration.rootElement;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Router.prototype, \"controllerAttribute\", {\n    get: function get() {\n      return this.configuration.controllerAttribute;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Router.prototype.start = function () {\n    this.tokenListObserver.start();\n  };\n  Router.prototype.stop = function () {\n    this.tokenListObserver.stop();\n  };\n  Router.prototype.register = function (identifier, controllerConstructor) {\n    if (this.contextSets.has(identifier)) {\n      throw new Error(\"Router already has a controller registered with the identifier '\" + identifier + \"'\");\n    }\n    var contextSet = new _context_set.ContextSet(this, identifier, controllerConstructor);\n    this.contextSets.set(identifier, contextSet);\n    this.connectContextSet(contextSet);\n  };\n  Router.prototype.unregister = function (identifier) {\n    var contextSet = this.contextSets.get(identifier);\n    if (contextSet) {\n      this.disconnectContextSet(contextSet);\n      this.contextSets.delete(identifier);\n    }\n  };\n  // Token list observer delegate\n  Router.prototype.elementMatchedTokenForAttribute = function (element, token, attributeName) {\n    this.connectContextForIdentifierToElement(token, element);\n  };\n  Router.prototype.elementUnmatchedTokenForAttribute = function (element, token, attributeName) {\n    this.disconnectContextForIdentifierFromElement(token, element);\n  };\n  // Contexts\n  Router.prototype.getContextForElementAndIdentifier = function (element, identifier) {\n    var contextSet = this.contextSets.get(identifier);\n    if (contextSet) {\n      return contextSet.getContextForElement(element);\n    }\n  };\n  Router.prototype.connectContextSet = function (contextSet) {\n    var elements = this.tokenListObserver.getElementsMatchingToken(contextSet.identifier);\n    for (var _i = 0, elements_1 = elements; _i < elements_1.length; _i++) {\n      var element = elements_1[_i];\n      contextSet.connect(element);\n    }\n  };\n  Router.prototype.disconnectContextSet = function (contextSet) {\n    var contexts = contextSet.contexts;\n    for (var _i = 0, contexts_1 = contexts; _i < contexts_1.length; _i++) {\n      var element = contexts_1[_i].element;\n      contextSet.disconnect(element);\n    }\n  };\n  Router.prototype.connectContextForIdentifierToElement = function (identifier, element) {\n    var contextSet = this.contextSets.get(identifier);\n    if (contextSet) {\n      contextSet.connect(element);\n    }\n  };\n  Router.prototype.disconnectContextForIdentifierFromElement = function (identifier, element) {\n    var contextSet = this.contextSets.get(identifier);\n    if (contextSet) {\n      contextSet.disconnect(element);\n    }\n  };\n  return Router;\n}();\nexports.Router = Router;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQHN0aW11bHVzL2NvcmUvc3JjL3JvdXRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFBO0FBRTFDLE9BQU8sRUFBRSxpQkFBaUIsRUFBNkIsTUFBTSw4QkFBOEIsQ0FBQTtBQUUzRjtJQUtFLGdCQUFZLFdBQXdCO1FBQ2xDLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFBO1FBQzlCLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLGlCQUFpQixDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLG1CQUFtQixFQUFFLElBQUksQ0FBQyxDQUFBO1FBQzVGLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxHQUFHLENBQUE7SUFDNUIsQ0FBQztJQUVELHNCQUFJLGlDQUFhO2FBQWpCO1lBQ0UsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFBO1FBQ3ZDLENBQUM7OztPQUFBO0lBRUQsc0JBQUksMkJBQU87YUFBWDtZQUNFLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQTtRQUN2QyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLHVDQUFtQjthQUF2QjtZQUNFLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLG1CQUFtQixDQUFBO1FBQy9DLENBQUM7OztPQUFBO0lBRUQsc0JBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtJQUNoQyxDQUFDO0lBRUQscUJBQUksR0FBSjtRQUNFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtJQUMvQixDQUFDO0lBRUQseUJBQVEsR0FBUixVQUFTLFVBQWtCLEVBQUUscUJBQTRDO1FBQ3ZFLEVBQUUsQ0FBQyxDQUFDLElBQUks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"},"hash":"46aa11bd15857358d196d27c8b9ddd68"}